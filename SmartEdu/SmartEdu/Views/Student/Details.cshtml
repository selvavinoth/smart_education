@model SmartEdu.ViewModel.StudentViewModel
@{
    Layout = null;
}
@Html.Partial("_Scripts")
@Html.Partial("_GridScript")
<div id="pageMainDiv" align="center" style="padding-top:0px;width:100%;height:100%;">
    <div  id="tabs" style="width: 100%; height: 100%;">
        <ul>
            <li><a href="#StudentDetail">Staff Detail</a></li>
            <li><a href="#ParentDetails">Parent Details</a></li>
            <li><a href="#StudentAuthentication">Authentication Details</a></li>
            <li><a href="#StudentAddress">Address Details</a></li>
        </ul>
    <div id="StudentDetail" style="overflow:auto;">
            @Html.Partial("_CommonUserDetails", Model.UserViewModel) 
    </div>
    <div id="ParentDetails" style="overflow:auto;">
            @Html.Partial("_ParentDetails", Model.ParentViewModel) 
    </div>
    <div id="StudentAuthentication">
        @Html.Partial("_Authentication", Model.UserAuthentication) 
    </div>
    <div id="StudentAddress">
        @Html.Partial("_Address",Model.AddressViewModel)
    </div>
    </div>
    <div style="width:100%;height:100%;" align="right">
       <input type="button" onclick="fnSaveStudent();" value="Save" style="padding-right:10px;"/>
        <input type="button" onclick="fnCancel();" value="Cancel" />
    </div>
</div>
<script type="text/javascript">
    $(function () {
        var bH = parent.ContentHeight();
        $("#tabs").height(String(bH - 50) + "px");
        $("#StudentDetail").height(String(bH - 170) + "px");
        $("#StudentAuthentication").height(String(bH - 170) + "px");
        $("#StudentAddress").height(String(bH - 170) + "px");
        $("#ParentDetails").height(String(bH - 170) + "px");
        if (typeof fnSetAddressPageSize == 'function') { fnSetAddressPageSize(parent.ContentWidth() - 70, bH - 100); }
        if (typeof fnInitAddressGrid == 'function') { fnInitAddressGrid(); }
        $('#tabs').tabs();
    });
    function fnValidateStudent() {
        var flag = true;
        if (typeof fnValidateUser == 'function') { flag = fnValidateUser(); }
        if (typeof fnValidateAuthentication == 'function') { flag = fnValidateAuthentication(); }
        if (typeof fnValidateAddress == 'function') { flag = fnValidateAddress(); }
        if (typeof fnValidateParent == 'function') { flag = fnValidateParent(); }
        return flag;
    }
    function fnCancel() { location.href = '@Url.Content("~/Student/Index")'; }
    function fnSaveStudent() {
        if (!fnValidateStudent()) { return false; }
        var data = fnGetStudentData();
        $.ajax({
            url: '@Url.Content("~/Student/StudentIUAction")',
            type: "POST",
            contentType: "application/json",
            dataType: "Json",
            data: JSON.stringify(data),
            success: function (obj) {
                if (obj && obj != null) {
                    if (obj.Msg && obj.Msg != null) { alert(obj.Msg); }
                    if (obj.Status) { location.href = '@Url.Content("~/Student/Index")'; }
                }
            },
            error: function (a, b) { }
        });
    }

    function fnGetStudentData() {
        var StudentViewModel = {};
        if (typeof fnGetUserData == 'function') { StudentViewModel.UserViewModel = fnGetUserData(); }
        if (typeof fnGetAuthenticationData == 'function') { StudentViewModel.UserAuthentication = fnGetAuthenticationData(); }
        if (typeof _fnGetAddressViewModel == 'function') { StudentViewModel.AddressList = _fnGetAddressViewModel(); }
        if (typeof fnGetParentData == 'function') { StudentViewModel.ParentViewModel = fnGetParentData(); }
        return StudentViewModel;
    }
    function fnClearStudent() { 
         if (typeof _fnClearUserDetails == 'function') { _fnClearUserDetails(); }
         if (typeof _fnClearParentDetails == 'function') { _fnClearUserDetails(); }
    }
</script>